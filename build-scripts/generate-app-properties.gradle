task generateAppProperties() {
    def dir = "$projectDir/src/main/resources"
    def fileName = "application.properties"
    doLast {
        def resDir = file(dir)
        if (!resDir.exists()) {
            println("Creating /src/main/resources dir...")
            file(dir).mkdirs()
        }
        def jwtSecret = userInput("Enter the jwtSecret: ")
        if (jwtSecret.isEmpty()) {
            throw new RuntimeException("jwtSecret cannot be null.")
        }
        def text = "jwt.token.secret=$jwtSecret"
        println("Generating application.properties...")
        def propertiesFile = file("$dir/$fileName")
        if (propertiesFile.exists()) {
            propertiesFile.delete()
        }
        propertiesFile << text
    }
}

static def userInput(String promptLine) {
    println(promptLine)
    def reader = System.in.newReader()
    return reader.readLine()
}

build.dependsOn generateAppProperties